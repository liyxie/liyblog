<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.liy.mapper.CalendarMapper">

    <select id="selectCalendarList" resultType="com.liy.vo.calendar.CalendarListVO">
        SELECT 
            id,
            creator_id as creatorId,
            title,
            start,
            end,
            content,
            bgcolor,
            draggable,
            resizable,
            deletable,
            all_day as allDay,
            recurring,
            class as className,
            create_time as createTime,
            update_time as updateTime
        FROM b_calendar 
        WHERE is_dalete = 0
        <if test="creatorId != null and creatorId != ''">
            AND creator_id = #{creatorId}
        </if>
        <if test="title != null and title != ''">
            AND title LIKE CONCAT('%', #{title}, '%')
        </if>
        ORDER BY start DESC
    </select>

    <select id="selectCalendarByDateRange" resultType="com.liy.vo.calendar.CalendarListVO">
        SELECT 
            id,
            creator_id as creatorId,
            title,
            start,
            end,
            content,
            bgcolor,
            draggable,
            resizable,
            deletable,
            all_day as allDay,
            recurring,
            class as className,
            create_time as createTime,
            update_time as updateTime
        FROM b_calendar 
        WHERE is_dalete = 0
        AND creator_id = #{creatorId}
        <if test="startDate != null and endDate != null">
            AND (
                (start &gt;= #{startDate} AND start &lt;= #{endDate})
                OR (end &gt;= #{startDate} AND end &lt;= #{endDate})
                OR (start &lt;= #{startDate} AND end &gt;= #{endDate})
            )
        </if>
        ORDER BY start ASC
    </select>

    <select id="selectUserCalendarList" resultType="com.liy.vo.calendar.CalendarListVO">
        SELECT 
            id,
            creator_id as creatorId,
            title,
            start,
            end,
            content,
            bgcolor,
            draggable,
            resizable,
            deletable,
            all_day as allDay,
            recurring,
            class as className,
            create_time as createTime,
            update_time as updateTime
        FROM b_calendar 
        WHERE is_dalete = 0 AND creator_id = #{creatorId}
        ORDER BY start DESC
    </select>

</mapper>